# ~~ Generated by projen. To modify, edit .projenrc.ts and run "npx projen".

version: "3.3"
services:
  app:
    build:
      context: ./containers
      dockerfile: Dockerfile.app
      args:
        BUN_VERSION: 1.0.25-slim
    environment:
      ENVIRONMENT: local
      AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID:-}
      AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY:-}
      AWS_SESSION_TOKEN: ${AWS_SESSION_TOKEN:-}
      AWS_REGION: ${AWS_REGION:-ap-southeast-2}
      PORT: "3000"
      IMAGE_STORE_BUCKET: ${IMAGE_STORE_BUCKET:-}
    ports:
      - target: 3000
        published: 3000
        protocol: tcp
        mode: host
    volumes:
      - type: bind
        source: ./
        target: /app
  terraform:
    build:
      context: ./containers
      dockerfile: Dockerfile.terraform
      args:
        TERRAFORM_VERSION: 1.5.5
    environment:
      APP_ENVIRONMENT: ${APP_ENVIRONMENT:-dev}
      APP_NAME: digital
      COMPONENT: image-optimisation-module
      AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID:-}
      AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY:-}
      AWS_SESSION_TOKEN: ${AWS_SESSION_TOKEN:-}
      AWS_REGION: ${AWS_REGION:-ap-southeast-2}
    volumes:
      - type: bind
        source: ./terraform
        target: /app
